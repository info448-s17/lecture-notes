<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Android Development: Lecture Notes</title>
  <meta content="text/html; charset=UTF-8" http-equiv="Content-Type">
  <meta name="description" content="Lecture notes for Info 448 Mobile Development: Android.">
  <meta name="generator" content="bookdown 0.3 and GitBook 2.6.7">

  <meta property="og:title" content="Android Development: Lecture Notes" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Lecture notes for Info 448 Mobile Development: Android." />
  <meta name="github-repo" content="info448-s17/lecture-notes" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Android Development: Lecture Notes" />
  
  <meta name="twitter:description" content="Lecture notes for Info 448 Mobile Development: Android." />
  

<meta name="author" content="Joel Ross">


<meta name="date" content="2017-05-23">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="multi-touch.html">
<link rel="next" href="java-review.html">

<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />







<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-98444716-1', 'auto');
  ga('send', 'pageview');

</script>


<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="css/style.css" type="text/css" />
</head>

<body>


  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Android Development</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>About this Book</a></li>
<li class="part"><span><b>I Lectures</b></span></li>
<li class="chapter" data-level="1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>1</b> Introduction</a><ul>
<li class="chapter" data-level="1.1" data-path="introduction.html"><a href="introduction.html#android-history"><i class="fa fa-check"></i><b>1.1</b> Android History</a><ul>
<li class="chapter" data-level="1.1.1" data-path="introduction.html"><a href="introduction.html#android-versions"><i class="fa fa-check"></i><b>1.1.1</b> Android Versions</a></li>
<li class="chapter" data-level="1.1.2" data-path="introduction.html"><a href="introduction.html#legal-battles"><i class="fa fa-check"></i><b>1.1.2</b> Legal Battles</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="introduction.html"><a href="introduction.html#android-architecture-and-code"><i class="fa fa-check"></i><b>1.2</b> Android Architecture and Code</a><ul>
<li class="chapter" data-level="1.2.1" data-path="introduction.html"><a href="introduction.html#programming-languages"><i class="fa fa-check"></i><b>1.2.1</b> Programming Languages</a></li>
<li class="chapter" data-level="1.2.2" data-path="introduction.html"><a href="introduction.html#building-apps"><i class="fa fa-check"></i><b>1.2.2</b> Building Apps</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="introduction.html"><a href="introduction.html#development-tools"><i class="fa fa-check"></i><b>1.3</b> Development Tools</a><ul>
<li class="chapter" data-level="1.3.1" data-path="introduction.html"><a href="introduction.html#hardware"><i class="fa fa-check"></i><b>1.3.1</b> Hardware</a></li>
<li class="chapter" data-level="1.3.2" data-path="introduction.html"><a href="introduction.html#software"><i class="fa fa-check"></i><b>1.3.2</b> Software</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="introduction.html"><a href="introduction.html#hello-world"><i class="fa fa-check"></i><b>1.4</b> Hello World</a><ul>
<li class="chapter" data-level="1.4.1" data-path="introduction.html"><a href="introduction.html#the-emulator"><i class="fa fa-check"></i><b>1.4.1</b> The Emulator</a></li>
<li class="chapter" data-level="1.4.2" data-path="introduction.html"><a href="introduction.html#project-contents"><i class="fa fa-check"></i><b>1.4.2</b> Project Contents</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="activities.html"><a href="activities.html"><i class="fa fa-check"></i><b>2</b> Activities and Logging</a><ul>
<li class="chapter" data-level="2.1" data-path="activities.html"><a href="activities.html#making-activities"><i class="fa fa-check"></i><b>2.1</b> Making Activities</a></li>
<li class="chapter" data-level="2.2" data-path="activities.html"><a href="activities.html#the-activity-lifecycle"><i class="fa fa-check"></i><b>2.2</b> The Activity Lifecycle</a><ul>
<li class="chapter" data-level="2.2.1" data-path="activities.html"><a href="activities.html#overriding-the-callback-methods"><i class="fa fa-check"></i><b>2.2.1</b> Overriding the Callback Methods</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="activities.html"><a href="activities.html#logging-adb"><i class="fa fa-check"></i><b>2.3</b> Logging &amp; ADB</a><ul>
<li class="chapter" data-level="2.3.1" data-path="activities.html"><a href="activities.html#log-methods"><i class="fa fa-check"></i><b>2.3.1</b> Log Methods</a></li>
<li class="chapter" data-level="2.3.2" data-path="activities.html"><a href="activities.html#logcat"><i class="fa fa-check"></i><b>2.3.2</b> Logcat</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="activities.html"><a href="activities.html#basic-events"><i class="fa fa-check"></i><b>2.4</b> Basic Events</a></li>
<li class="chapter" data-level="2.5" data-path="activities.html"><a href="activities.html#multiple-activities"><i class="fa fa-check"></i><b>2.5</b> Multiple Activities</a><ul>
<li class="chapter" data-level="2.5.1" data-path="activities.html"><a href="activities.html#intents-and-context"><i class="fa fa-check"></i><b>2.5.1</b> Intents and Context</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="activities.html"><a href="activities.html#back-tasks"><i class="fa fa-check"></i><b>2.6</b> Back &amp; Tasks</a><ul>
<li class="chapter" data-level="2.6.1" data-path="activities.html"><a href="activities.html#up-navigation"><i class="fa fa-check"></i><b>2.6.1</b> Up Navigation</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="resources-and-layouts.html"><a href="resources-and-layouts.html"><i class="fa fa-check"></i><b>3</b> Resources and Layouts</a><ul>
<li class="chapter" data-level="3.1" data-path="resources-and-layouts.html"><a href="resources-and-layouts.html#resources"><i class="fa fa-check"></i><b>3.1</b> Resources</a><ul>
<li class="chapter" data-level="3.1.1" data-path="resources-and-layouts.html"><a href="resources-and-layouts.html#alternative-resources"><i class="fa fa-check"></i><b>3.1.1</b> Alternate Resources</a></li>
<li class="chapter" data-level="3.1.2" data-path="resources-and-layouts.html"><a href="resources-and-layouts.html#xml-details"><i class="fa fa-check"></i><b>3.1.2</b> XML Details</a></li>
<li class="chapter" data-level="3.1.3" data-path="resources-and-layouts.html"><a href="resources-and-layouts.html#r"><i class="fa fa-check"></i><b>3.1.3</b> R</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="resources-and-layouts.html"><a href="resources-and-layouts.html#views"><i class="fa fa-check"></i><b>3.2</b> Views</a><ul>
<li class="chapter" data-level="3.2.1" data-path="resources-and-layouts.html"><a href="resources-and-layouts.html#view-properties"><i class="fa fa-check"></i><b>3.2.1</b> View Properties</a></li>
<li class="chapter" data-level="3.2.2" data-path="resources-and-layouts.html"><a href="resources-and-layouts.html#practice"><i class="fa fa-check"></i><b>3.2.2</b> Practice</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="resources-and-layouts.html"><a href="resources-and-layouts.html#layouts"><i class="fa fa-check"></i><b>3.3</b> Layouts</a><ul>
<li class="chapter" data-level="3.3.1" data-path="resources-and-layouts.html"><a href="resources-and-layouts.html#linearlayout"><i class="fa fa-check"></i><b>3.3.1</b> LinearLayout</a></li>
<li class="chapter" data-level="3.3.2" data-path="resources-and-layouts.html"><a href="resources-and-layouts.html#relativelayout"><i class="fa fa-check"></i><b>3.3.2</b> RelativeLayout</a></li>
<li class="chapter" data-level="3.3.3" data-path="resources-and-layouts.html"><a href="resources-and-layouts.html#constraintlayout"><i class="fa fa-check"></i><b>3.3.3</b> ConstraintLayout</a></li>
<li class="chapter" data-level="3.3.4" data-path="resources-and-layouts.html"><a href="resources-and-layouts.html#other-layouts"><i class="fa fa-check"></i><b>3.3.4</b> Other Layouts</a></li>
<li class="chapter" data-level="3.3.5" data-path="resources-and-layouts.html"><a href="resources-and-layouts.html#combining-and-inflating-layouts"><i class="fa fa-check"></i><b>3.3.5</b> Combining and Inflating Layouts</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="interactive-views.html"><a href="interactive-views.html"><i class="fa fa-check"></i><b>4</b> Interactive Views</a><ul>
<li class="chapter" data-level="4.1" data-path="interactive-views.html"><a href="interactive-views.html#inputs"><i class="fa fa-check"></i><b>4.1</b> Inputs</a></li>
<li class="chapter" data-level="4.2" data-path="interactive-views.html"><a href="interactive-views.html#listviews-and-adapters"><i class="fa fa-check"></i><b>4.2</b> ListViews and Adapters</a></li>
<li class="chapter" data-level="4.3" data-path="interactive-views.html"><a href="interactive-views.html#network-data"><i class="fa fa-check"></i><b>4.3</b> Network Data</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="fragments.html"><a href="fragments.html"><i class="fa fa-check"></i><b>5</b> Fragments</a><ul>
<li class="chapter" data-level="5.1" data-path="fragments.html"><a href="fragments.html#creating-a-fragment"><i class="fa fa-check"></i><b>5.1</b> Creating a Fragment</a><ul>
<li class="chapter" data-level="5.1.1" data-path="fragments.html"><a href="fragments.html#activity-to-fragment-communication"><i class="fa fa-check"></i><b>5.1.1</b> Activity-to-Fragment Communication</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="fragments.html"><a href="fragments.html#dynamic-fragments"><i class="fa fa-check"></i><b>5.2</b> Dynamic Fragments</a><ul>
<li class="chapter" data-level="5.2.1" data-path="fragments.html"><a href="fragments.html#instantiating-fragments"><i class="fa fa-check"></i><b>5.2.1</b> Instantiating Fragments</a></li>
<li class="chapter" data-level="5.2.2" data-path="fragments.html"><a href="fragments.html#transactions"><i class="fa fa-check"></i><b>5.2.2</b> Transactions</a></li>
<li class="chapter" data-level="5.2.3" data-path="fragments.html"><a href="fragments.html#inter-fragment-communication"><i class="fa fa-check"></i><b>5.2.3</b> Inter-Fragment Communication</a></li>
<li class="chapter" data-level="5.2.4" data-path="fragments.html"><a href="fragments.html#the-back-stack"><i class="fa fa-check"></i><b>5.2.4</b> The Back Stack</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="ui-components.html"><a href="ui-components.html"><i class="fa fa-check"></i><b>6</b> UI Components</a><ul>
<li class="chapter" data-level="6.1" data-path="ui-components.html"><a href="ui-components.html#the-action-bar"><i class="fa fa-check"></i><b>6.1</b> The Action Bar</a></li>
<li class="chapter" data-level="6.2" data-path="ui-components.html"><a href="ui-components.html#menus"><i class="fa fa-check"></i><b>6.2</b> Menus</a><ul>
<li class="chapter" data-level="6.2.1" data-path="ui-components.html"><a href="ui-components.html#context-menus"><i class="fa fa-check"></i><b>6.2.1</b> Context Menus</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="ui-components.html"><a href="ui-components.html#dialogs"><i class="fa fa-check"></i><b>6.3</b> Dialogs</a><ul>
<li class="chapter" data-level="6.3.1" data-path="ui-components.html"><a href="ui-components.html#dialogfragments"><i class="fa fa-check"></i><b>6.3.1</b> DialogFragments</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="ui-components.html"><a href="ui-components.html#toasts"><i class="fa fa-check"></i><b>6.4</b> Toasts</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="providers-and-loaders.html"><a href="providers-and-loaders.html"><i class="fa fa-check"></i><b>7</b> Providers and Loaders</a><ul>
<li class="chapter" data-level="7.1" data-path="providers-and-loaders.html"><a href="providers-and-loaders.html#content-providers"><i class="fa fa-check"></i><b>7.1</b> Content Providers</a></li>
<li class="chapter" data-level="7.2" data-path="providers-and-loaders.html"><a href="providers-and-loaders.html#cursors"><i class="fa fa-check"></i><b>7.2</b> Cursors</a></li>
<li class="chapter" data-level="7.3" data-path="providers-and-loaders.html"><a href="providers-and-loaders.html#loaders"><i class="fa fa-check"></i><b>7.3</b> Loaders</a></li>
<li class="chapter" data-level="7.4" data-path="providers-and-loaders.html"><a href="providers-and-loaders.html#other-provider-actions"><i class="fa fa-check"></i><b>7.4</b> Other Provider Actions</a><ul>
<li class="chapter" data-level="7.4.1" data-path="providers-and-loaders.html"><a href="providers-and-loaders.html#adding-words"><i class="fa fa-check"></i><b>7.4.1</b> Adding Words</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="intents.html"><a href="intents.html"><i class="fa fa-check"></i><b>8</b> Intents</a><ul>
<li class="chapter" data-level="8.1" data-path="intents.html"><a href="intents.html#intents-for-another-activity-explicit"><i class="fa fa-check"></i><b>8.1</b> Intents for Another Activity (Explicit)</a><ul>
<li class="chapter" data-level="8.1.1" data-path="intents.html"><a href="intents.html#extras"><i class="fa fa-check"></i><b>8.1.1</b> Extras</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="intents.html"><a href="intents.html#intents-for-another-app-implicit"><i class="fa fa-check"></i><b>8.2</b> Intents for Another App (Implicit)</a></li>
<li class="chapter" data-level="8.3" data-path="intents.html"><a href="intents.html#intents-for-a-response"><i class="fa fa-check"></i><b>8.3</b> Intents for a Response</a></li>
<li class="chapter" data-level="8.4" data-path="intents.html"><a href="intents.html#listening-for-intents"><i class="fa fa-check"></i><b>8.4</b> Listening for Intents</a></li>
<li class="chapter" data-level="8.5" data-path="intents.html"><a href="intents.html#broadcasts-and-receivers"><i class="fa fa-check"></i><b>8.5</b> Broadcasts and Receivers</a></li>
<li class="chapter" data-level="8.6" data-path="intents.html"><a href="intents.html#an-example-sms"><i class="fa fa-check"></i><b>8.6</b> An Example: SMS</a></li>
<li class="chapter" data-level="8.7" data-path="intents.html"><a href="intents.html#shareactionprovider"><i class="fa fa-check"></i><b>8.7</b> ShareActionProvider</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="ui-components-ii.html"><a href="ui-components-ii.html"><i class="fa fa-check"></i><b>9</b> UI Components II</a><ul>
<li class="chapter" data-level="9.1" data-path="ui-components-ii.html"><a href="ui-components-ii.html#notifications"><i class="fa fa-check"></i><b>9.1</b> Notifications</a></li>
<li class="chapter" data-level="9.2" data-path="ui-components-ii.html"><a href="ui-components-ii.html#settings"><i class="fa fa-check"></i><b>9.2</b> Settings</a><ul>
<li class="chapter" data-level="9.2.1" data-path="ui-components-ii.html"><a href="ui-components-ii.html#sharedpreferences"><i class="fa fa-check"></i><b>9.2.1</b> SharedPreferences</a></li>
<li class="chapter" data-level="9.2.2" data-path="ui-components-ii.html"><a href="ui-components-ii.html#preference-settings"><i class="fa fa-check"></i><b>9.2.2</b> Preference Settings</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="files-and-permissions.html"><a href="files-and-permissions.html"><i class="fa fa-check"></i><b>10</b> Files and Permissions</a><ul>
<li class="chapter" data-level="10.1" data-path="files-and-permissions.html"><a href="files-and-permissions.html#file-storage-locations"><i class="fa fa-check"></i><b>10.1</b> File Storage Locations</a></li>
<li class="chapter" data-level="10.2" data-path="files-and-permissions.html"><a href="files-and-permissions.html#permissions"><i class="fa fa-check"></i><b>10.2</b> Permissions</a></li>
<li class="chapter" data-level="10.3" data-path="files-and-permissions.html"><a href="files-and-permissions.html#external-storage"><i class="fa fa-check"></i><b>10.3</b> External Storage</a></li>
<li class="chapter" data-level="10.4" data-path="files-and-permissions.html"><a href="files-and-permissions.html#internal-storage-cache"><i class="fa fa-check"></i><b>10.4</b> Internal Storage &amp; Cache</a></li>
<li class="chapter" data-level="10.5" data-path="files-and-permissions.html"><a href="files-and-permissions.html#example-saving-pictures"><i class="fa fa-check"></i><b>10.5</b> Example: Saving Pictures</a></li>
<li class="chapter" data-level="10.6" data-path="files-and-permissions.html"><a href="files-and-permissions.html#sharing-files"><i class="fa fa-check"></i><b>10.6</b> Sharing Files</a><ul>
<li class="chapter" data-level="10.6.1" data-path="files-and-permissions.html"><a href="files-and-permissions.html#bonus-sharing-with-a-fileprovider"><i class="fa fa-check"></i><b>10.6.1</b> Bonus: Sharing with a <code>FileProvider</code></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="location.html"><a href="location.html"><i class="fa fa-check"></i><b>11</b> Location</a><ul>
<li class="chapter" data-level="11.1" data-path="location.html"><a href="location.html#localization-techniques"><i class="fa fa-check"></i><b>11.1</b> Localization Techniques</a><ul>
<li class="chapter" data-level="11.1.1" data-path="location.html"><a href="location.html#gps"><i class="fa fa-check"></i><b>11.1.1</b> GPS</a></li>
<li class="chapter" data-level="11.1.2" data-path="location.html"><a href="location.html#cell-tower-localization"><i class="fa fa-check"></i><b>11.1.2</b> Cell Tower Localization</a></li>
<li class="chapter" data-level="11.1.3" data-path="location.html"><a href="location.html#wifi-localization"><i class="fa fa-check"></i><b>11.1.3</b> WiFi Localization</a></li>
<li class="chapter" data-level="11.1.4" data-path="location.html"><a href="location.html#representing-location"><i class="fa fa-check"></i><b>11.1.4</b> Representing Location</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="location.html"><a href="location.html#android-location"><i class="fa fa-check"></i><b>11.2</b> Android Location</a><ul>
<li class="chapter" data-level="11.2.1" data-path="location.html"><a href="location.html#google-play-services"><i class="fa fa-check"></i><b>11.2.1</b> Google Play Services</a></li>
<li class="chapter" data-level="11.2.2" data-path="location.html"><a href="location.html#accessing-location"><i class="fa fa-check"></i><b>11.2.2</b> Accessing Location</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="sensors.html"><a href="sensors.html"><i class="fa fa-check"></i><b>12</b> Sensors</a><ul>
<li class="chapter" data-level="12.1" data-path="sensors.html"><a href="sensors.html#motion-sensors"><i class="fa fa-check"></i><b>12.1</b> Motion Sensors</a><ul>
<li class="chapter" data-level="12.1.1" data-path="sensors.html"><a href="sensors.html#accessing-sensors"><i class="fa fa-check"></i><b>12.1.1</b> Accessing Sensors</a></li>
<li class="chapter" data-level="12.1.2" data-path="sensors.html"><a href="sensors.html#composite-sensors"><i class="fa fa-check"></i><b>12.1.2</b> Composite Sensors</a></li>
</ul></li>
<li class="chapter" data-level="12.2" data-path="sensors.html"><a href="sensors.html#rotation"><i class="fa fa-check"></i><b>12.2</b> Rotation</a><ul>
<li class="chapter" data-level="12.2.1" data-path="sensors.html"><a href="sensors.html#coordinates"><i class="fa fa-check"></i><b>12.2.1</b> Coordinates</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="13" data-path="services.html"><a href="services.html"><i class="fa fa-check"></i><b>13</b> Services</a><ul>
<li class="chapter" data-level="13.1" data-path="services.html"><a href="services.html#intentservices"><i class="fa fa-check"></i><b>13.1</b> IntentServices</a><ul>
<li class="chapter" data-level="13.1.1" data-path="services.html"><a href="services.html#the-service-lifecycle"><i class="fa fa-check"></i><b>13.1.1</b> The Service Lifecycle</a></li>
</ul></li>
<li class="chapter" data-level="13.2" data-path="services.html"><a href="services.html#example-a-music-service"><i class="fa fa-check"></i><b>13.2</b> Example: A Music Service</a><ul>
<li class="chapter" data-level="13.2.1" data-path="services.html"><a href="services.html#mediaplayer"><i class="fa fa-check"></i><b>13.2.1</b> MediaPlayer</a></li>
<li class="chapter" data-level="13.2.2" data-path="services.html"><a href="services.html#creating-a-service"><i class="fa fa-check"></i><b>13.2.2</b> Creating a Service</a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="services.html"><a href="services.html#foreground-services"><i class="fa fa-check"></i><b>13.3</b> Foreground Services</a></li>
<li class="chapter" data-level="13.4" data-path="services.html"><a href="services.html#bound-services"><i class="fa fa-check"></i><b>13.4</b> Bound Services</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="material-design.html"><a href="material-design.html"><i class="fa fa-check"></i><b>14</b> Material Design</a><ul>
<li class="chapter" data-level="14.1" data-path="material-design.html"><a href="material-design.html#resources-1"><i class="fa fa-check"></i><b>14.1</b> Resources:</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="animation.html"><a href="animation.html"><i class="fa fa-check"></i><b>15</b> Animation and Graphics</a><ul>
<li class="chapter" data-level="15.1" data-path="animation.html"><a href="animation.html#drawing-graphics"><i class="fa fa-check"></i><b>15.1</b> Drawing Graphics</a><ul>
<li class="chapter" data-level="15.1.1" data-path="animation.html"><a href="animation.html#custom-views"><i class="fa fa-check"></i><b>15.1.1</b> Custom Views</a></li>
<li class="chapter" data-level="15.1.2" data-path="animation.html"><a href="animation.html#surfaceviews"><i class="fa fa-check"></i><b>15.1.2</b> SurfaceViews</a></li>
</ul></li>
<li class="chapter" data-level="15.2" data-path="animation.html"><a href="animation.html#touch-and-gestures"><i class="fa fa-check"></i><b>15.2</b> Touch and Gestures</a><ul>
<li class="chapter" data-level="15.2.1" data-path="animation.html"><a href="animation.html#advanced-gestures"><i class="fa fa-check"></i><b>15.2.1</b> Advanced Gestures</a></li>
</ul></li>
<li class="chapter" data-level="15.3" data-path="animation.html"><a href="animation.html#property-animation"><i class="fa fa-check"></i><b>15.3</b> Property Animation</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="kotlin.html"><a href="kotlin.html"><i class="fa fa-check"></i><b>16</b> Special Topics: Kotlin</a><ul>
<li class="chapter" data-level="16.1" data-path="kotlin.html"><a href="kotlin.html#kotlin-syntax"><i class="fa fa-check"></i><b>16.1</b> Kotlin Syntax</a><ul>
<li class="chapter" data-level="16.1.1" data-path="kotlin.html"><a href="kotlin.html#variables"><i class="fa fa-check"></i><b>16.1.1</b> Variables</a></li>
<li class="chapter" data-level="16.1.2" data-path="kotlin.html"><a href="kotlin.html#functions"><i class="fa fa-check"></i><b>16.1.2</b> Functions</a></li>
<li class="chapter" data-level="16.1.3" data-path="kotlin.html"><a href="kotlin.html#classes"><i class="fa fa-check"></i><b>16.1.3</b> Classes</a></li>
</ul></li>
<li class="chapter" data-level="16.2" data-path="kotlin.html"><a href="kotlin.html#kotlin-for-android"><i class="fa fa-check"></i><b>16.2</b> Kotlin for Android</a><ul>
<li class="chapter" data-level="16.2.1" data-path="kotlin.html"><a href="kotlin.html#the-android-extension"><i class="fa fa-check"></i><b>16.2.1</b> The Android Extension</a></li>
<li class="chapter" data-level="16.2.2" data-path="kotlin.html"><a href="kotlin.html#anko"><i class="fa fa-check"></i><b>16.2.2</b> Anko</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="17" data-path="publishing.html"><a href="publishing.html"><i class="fa fa-check"></i><b>17</b> Publishing</a><ul>
<li class="chapter" data-level="17.1" data-path="publishing.html"><a href="publishing.html#signing-an-app"><i class="fa fa-check"></i><b>17.1</b> Signing an App</a><ul>
<li class="chapter" data-level="17.1.1" data-path="publishing.html"><a href="publishing.html#a-release-.apk"><i class="fa fa-check"></i><b>17.1.1</b> A Release <code>.apk</code></a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>II Additional Topics (Labs)</b></span></li>
<li class="chapter" data-level="18" data-path="accessibility.html"><a href="accessibility.html"><i class="fa fa-check"></i><b>18</b> Accessibility</a><ul>
<li class="chapter" data-level="18.1" data-path="accessibility.html"><a href="accessibility.html#universal-usability"><i class="fa fa-check"></i><b>18.1</b> Universal Usability</a></li>
<li class="chapter" data-level="18.2" data-path="accessibility.html"><a href="accessibility.html#implementing-accessibility"><i class="fa fa-check"></i><b>18.2</b> Implementing Accessibility</a><ul>
<li class="chapter" data-level="18.2.1" data-path="accessibility.html"><a href="accessibility.html#supporting-vision-impairment"><i class="fa fa-check"></i><b>18.2.1</b> Supporting Vision Impairment</a></li>
<li class="chapter" data-level="18.2.2" data-path="accessibility.html"><a href="accessibility.html#supporting-alternative-inputs"><i class="fa fa-check"></i><b>18.2.2</b> Supporting Alternative Inputs</a></li>
<li class="chapter" data-level="18.2.3" data-path="accessibility.html"><a href="accessibility.html#supporting-internationalization"><i class="fa fa-check"></i><b>18.2.3</b> Supporting Internationalization</a></li>
<li class="chapter" data-level="18.2.4" data-path="accessibility.html"><a href="accessibility.html#further-testing"><i class="fa fa-check"></i><b>18.2.4</b> Further Testing</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="19" data-path="fragments-viewpager.html"><a href="fragments-viewpager.html"><i class="fa fa-check"></i><b>19</b> Fragments: ViewPager</a><ul>
<li class="chapter" data-level="19.1" data-path="fragments-viewpager.html"><a href="fragments-viewpager.html#define-a-searchfragment"><i class="fa fa-check"></i><b>19.1</b> Define a SearchFragment</a></li>
<li class="chapter" data-level="19.2" data-path="fragments-viewpager.html"><a href="fragments-viewpager.html#add-the-viewpager-and-adapter"><i class="fa fa-check"></i><b>19.2</b> Add the ViewPager and Adapter</a></li>
<li class="chapter" data-level="19.3" data-path="fragments-viewpager.html"><a href="fragments-viewpager.html#add-user-interaction"><i class="fa fa-check"></i><b>19.3</b> Add User Interaction</a></li>
</ul></li>
<li class="chapter" data-level="20" data-path="bluetooth.html"><a href="bluetooth.html"><i class="fa fa-check"></i><b>20</b> Bluetooth</a></li>
<li class="chapter" data-level="21" data-path="maps.html"><a href="maps.html"><i class="fa fa-check"></i><b>21</b> Maps</a><ul>
<li class="chapter" data-level="21.1" data-path="maps.html"><a href="maps.html#create-a-map-activity"><i class="fa fa-check"></i><b>21.1</b> Create a Map Activity</a><ul>
<li class="chapter" data-level="21.1.1" data-path="maps.html"><a href="maps.html#getting-an-api-key"><i class="fa fa-check"></i><b>21.1.1</b> Getting an API Key</a></li>
<li class="chapter" data-level="21.1.2" data-path="maps.html"><a href="maps.html#the-supportmapfragment"><i class="fa fa-check"></i><b>21.1.2</b> The <code>SupportMapFragment</code></a></li>
</ul></li>
<li class="chapter" data-level="21.2" data-path="maps.html"><a href="maps.html#specifying-the-user-interface"><i class="fa fa-check"></i><b>21.2</b> Specifying the User Interface</a></li>
<li class="chapter" data-level="21.3" data-path="maps.html"><a href="maps.html#markers-and-drawings"><i class="fa fa-check"></i><b>21.3</b> Markers and Drawings</a><ul>
<li class="chapter" data-level="21.3.1" data-path="maps.html"><a href="maps.html#drawing-shapes"><i class="fa fa-check"></i><b>21.3.1</b> Drawing Shapes</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="22" data-path="styles-themes.html"><a href="styles-themes.html"><i class="fa fa-check"></i><b>22</b> Styles &amp; Themes</a><ul>
<li class="chapter" data-level="22.1" data-path="styles-themes.html"><a href="styles-themes.html#defining-styles"><i class="fa fa-check"></i><b>22.1</b> Defining Styles</a><ul>
<li class="chapter" data-level="22.1.1" data-path="styles-themes.html"><a href="styles-themes.html#style-inheritance"><i class="fa fa-check"></i><b>22.1.1</b> Style Inheritance</a></li>
<li class="chapter" data-level="22.1.2" data-path="styles-themes.html"><a href="styles-themes.html#built-in-styles"><i class="fa fa-check"></i><b>22.1.2</b> Built-in Styles</a></li>
</ul></li>
<li class="chapter" data-level="22.2" data-path="styles-themes.html"><a href="styles-themes.html#themes"><i class="fa fa-check"></i><b>22.2</b> Themes</a><ul>
<li class="chapter" data-level="22.2.1" data-path="styles-themes.html"><a href="styles-themes.html#material-themes"><i class="fa fa-check"></i><b>22.2.1</b> Material Themes</a></li>
<li class="chapter" data-level="22.2.2" data-path="styles-themes.html"><a href="styles-themes.html#theme-attributes"><i class="fa fa-check"></i><b>22.2.2</b> Theme Attributes</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="23" data-path="multi-touch.html"><a href="multi-touch.html"><i class="fa fa-check"></i><b>23</b> Multi-Touch</a><ul>
<li class="chapter" data-level="23.1" data-path="multi-touch.html"><a href="multi-touch.html#identifying-fingers"><i class="fa fa-check"></i><b>23.1</b> Identifying Fingers</a></li>
<li class="chapter" data-level="23.2" data-path="multi-touch.html"><a href="multi-touch.html#drawing-touches"><i class="fa fa-check"></i><b>23.2</b> Drawing Touches</a></li>
<li class="chapter" data-level="23.3" data-path="multi-touch.html"><a href="multi-touch.html#moving-fingers"><i class="fa fa-check"></i><b>23.3</b> Moving Fingers</a></li>
<li class="chapter" data-level="23.4" data-path="multi-touch.html"><a href="multi-touch.html#other-multi-touch-gestures"><i class="fa fa-check"></i><b>23.4</b> Other Multi-Touch Gestures</a></li>
</ul></li>
<li class="chapter" data-level="24" data-path="memory.html"><a href="memory.html"><i class="fa fa-check"></i><b>24</b> Memory Management</a><ul>
<li class="chapter" data-level="24.1" data-path="memory.html"><a href="memory.html#memory-allocation"><i class="fa fa-check"></i><b>24.1</b> Memory Allocation</a></li>
<li class="chapter" data-level="24.2" data-path="memory.html"><a href="memory.html#the-memory-monitor"><i class="fa fa-check"></i><b>24.2</b> The Memory Monitor</a><ul>
<li class="chapter" data-level="24.2.1" data-path="memory.html"><a href="memory.html#garbage-collection"><i class="fa fa-check"></i><b>24.2.1</b> Garbage Collection</a></li>
</ul></li>
<li class="chapter" data-level="24.3" data-path="memory.html"><a href="memory.html#memory-leaks"><i class="fa fa-check"></i><b>24.3</b> Memory Leaks</a></li>
</ul></li>
<li class="appendix"><span><b>Appendix: Java</b></span></li>
<li class="chapter" data-level="A" data-path="java-review.html"><a href="java-review.html"><i class="fa fa-check"></i><b>A</b> Java Review</a><ul>
<li class="chapter" data-level="A.1" data-path="java-review.html"><a href="java-review.html#building-apps-with-gradle"><i class="fa fa-check"></i><b>A.1</b> Building Apps with Gradle</a></li>
<li class="chapter" data-level="A.2" data-path="java-review.html"><a href="java-review.html#class-basics"><i class="fa fa-check"></i><b>A.2</b> Class Basics</a></li>
<li class="chapter" data-level="A.3" data-path="java-review.html"><a href="java-review.html#inheritance"><i class="fa fa-check"></i><b>A.3</b> Inheritance</a></li>
<li class="chapter" data-level="A.4" data-path="java-review.html"><a href="java-review.html#interfaces"><i class="fa fa-check"></i><b>A.4</b> Interfaces</a></li>
<li class="chapter" data-level="A.5" data-path="java-review.html"><a href="java-review.html#polymorphism"><i class="fa fa-check"></i><b>A.5</b> Polymorphism</a></li>
<li class="chapter" data-level="A.6" data-path="java-review.html"><a href="java-review.html#abstract-methods-and-classes"><i class="fa fa-check"></i><b>A.6</b> Abstract Methods and Classes</a></li>
<li class="chapter" data-level="A.7" data-path="java-review.html"><a href="java-review.html#generics"><i class="fa fa-check"></i><b>A.7</b> Generics</a></li>
<li class="chapter" data-level="A.8" data-path="java-review.html"><a href="java-review.html#nested-classes"><i class="fa fa-check"></i><b>A.8</b> Nested Classes</a></li>
</ul></li>
<li class="chapter" data-level="B" data-path="java-swing.html"><a href="java-swing.html"><i class="fa fa-check"></i><b>B</b> Swing Framework</a><ul>
<li class="chapter" data-level="B.1" data-path="java-swing.html"><a href="java-swing.html#events"><i class="fa fa-check"></i><b>B.1</b> Events</a></li>
<li class="chapter" data-level="B.2" data-path="java-swing.html"><a href="java-swing.html#layouts-and-composites"><i class="fa fa-check"></i><b>B.2</b> Layouts and Composites</a></li>
</ul></li>
<li class="chapter" data-level="C" data-path="java-threads-http.html"><a href="java-threads-http.html"><i class="fa fa-check"></i><b>C</b> Threads and HTTP Requests</a><ul>
<li class="chapter" data-level="C.1" data-path="java-threads-http.html"><a href="java-threads-http.html#concurrency"><i class="fa fa-check"></i><b>C.1</b> Concurrency</a><ul>
<li class="chapter" data-level="C.1.1" data-path="java-threads-http.html"><a href="java-threads-http.html#an-example-algorithm-races"><i class="fa fa-check"></i><b>C.1.1</b> An Example: Algorithm Races!</a></li>
<li class="chapter" data-level="C.1.2" data-path="java-threads-http.html"><a href="java-threads-http.html#threading-the-race"><i class="fa fa-check"></i><b>C.1.2</b> Threading the Race</a></li>
</ul></li>
<li class="chapter" data-level="C.2" data-path="java-threads-http.html"><a href="java-threads-http.html#http-requests"><i class="fa fa-check"></i><b>C.2</b> HTTP Requests</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Android Development: Lecture Notes</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="memory" class="section level1">
<h1><span class="header-section-number">Lecture 24</span> Memory Management</h1>
<p>Android is designed to run on <em>resource constrained</em> devices, and one of the most constrained resources is the device’s <a href="https://en.wikipedia.org/wiki/Computer_memory"><strong>memory</strong></a>. Because of this, a large part of the Android framework and how we interact with application components deals with how the system <a href="https://developer.android.com/topic/performance/memory.html">manages memory</a>, making sure sufficient memory is available for whatever the user wants to do.</p>
<p>In this short tutorial, you will explore how the Android operating system handles memory, and learn how to use the <a href="https://developer.android.com/studio/profile/android-monitor.html">Android Monitor</a>’s <a href="https://developer.android.com/studio/profile/am-memory.html">Memory Monitor</a> to view your application’s memory usage and identify potential <a href="https://en.wikipedia.org/wiki/Memory_leak">memory leaks</a>.</p>
<p class="alert alert-info">
The code for this tutorial can be found at <a href="https://github.com/info448-s17/lab-memory" class="uri">https://github.com/info448-s17/lab-memory</a>. Note that you will not be required to write much code for this lab; it is more about using the tools and inspecting the logged output to get a sense for how memory is handled in Android. You should be able to complete this tutorial on <em>either</em> the emulator or a physical device.
</p>
<div id="memory-allocation" class="section level2">
<h2><span class="header-section-number">24.1</span> Memory Allocation</h2>
<p>First, a short introduction to how memory is handled by a computer (including mobile computers):</p>
<p>The basic idea is that your computer has some amount of storage space (in <a href="https://en.wikipedia.org/wiki/Random-access_memory">RAM</a>) dedicating to remembering all of the variables and objects that you create in your program. If you declare a new variable</p>
<div class="sourceCode"><pre class="sourceCode java"><code class="sourceCode java"><span class="dt">int</span> number = <span class="dv">448</span>;</code></pre></div>
<p>that value (<code>448</code>) is “written down” in memory so it can be used later. For example, this <code>int</code> takes up 32 bits, or 4 bytes, of memory. Every single variable you create takes up some amount of memory (see e.g., <a href="http://www.javamex.com/tutorials/memory/object_memory_usage.shtml">here</a>).</p>
<p>This data is stored in a section of memory called the “<strong>heap</strong>”, which is the part of memory dedicated to <em>dynamic</em> memory (e.g., values that may only need to be remembered for a short time). You can think of the heap as a something like a giant <em>array</em> or <em>list</em> of bytes, a certain number of which are <strong>allocated</strong> (given) to each new value that needs to be stored. Thus if spots 0 through 100 in the heap are allocated, declaring a new variable may be allocated (placed) at spot 101.</p>
<div class="figure">
<img src="img/memory/allocation.png" alt="Example of memory allocation, from dynatrace.com." />
<p class="caption">Example of memory allocation, from <a href="http://www.dynatrace.com/en/javabook/how-garbage-collection-works.html">dynatrace.com</a>.</p>
</div>
<p><strong>Memory management</strong> thus involves answering two questions:</p>
<ol style="list-style-type: decimal">
<li>Where do we put new values that we need to allocate memory for?</li>
<li>What do we do with variables that we no longer need to remember?</li>
</ol>
<p>Java (and by extension, Android) answers the second question in part by using what is called the <a href="https://plumbr.eu/handbook/garbage-collection-in-java"><strong>garbage collector</strong></a>. This is a system process that periodically “sweeps” (searches) for any values that are no longer being used—that is, the variables are out of scope or otherwise cannot be referenced. These values are then “garbage collected”: the space is <em>deallocated</em> so that future values can be placed there instead.</p>
<ul>
<li><p>Garbage collection is a bit like going through an apartment and marking rooms as “vacant” if no one lives there anymore.</p></li>
<li><p>Java’s garbage collection means we don’t need to handle deallocating memory ourselves—unlike in languages such as <strong>C</strong> where you need to manually manage your own memory!</p></li>
</ul>
<p>The Android framework is structured so that when memory gets low, the system will <a href="https://developer.android.com/guide/topics/processes/process-lifecycle.html">destroy</a> any <em>stopped</em> Activities, thereby allowing them to be garbage collected (and freeing up the memory to be used by a different application). You’ll be able to see this process in action in the next section.</p>
</div>
<div id="the-memory-monitor" class="section level2">
<h2><span class="header-section-number">24.2</span> The Memory Monitor</h2>
<p>Since we’re interested in the memory used by the application, you should enable and view the <a href="http://developer.android.com/tools/help/am-basics.html#displaying">Memory Monitor</a> provided by Android Studio. If you look at the bottom panel (the <code>Android Monitor</code> panel) where you normally see the <code>Logcat</code> results, you should see a tab called <code>Monitors</code>. Click on this to view the memory usage over time (you can ignore the other monitors for now).</p>
<div class="figure">
<img src="img/memory/am-androidmon2.png" alt="Android Memory Monitor (Google)" />
<p class="caption">Android Memory Monitor (<a href="https://developer.android.com/images/tools/am-androidmon2.png">Google</a>)</p>
</div>
<p>The dark-blue section represents <strong>allocated</strong> memory (i.e., the amount of memory being used to store variables), while the light-blue section represents <strong>free</strong> memory (in this case, the amount of memory that the <em>application</em> is budgeted by the operating system). Each section also has a size in megabytes listed on the right. We’re primarily interested in the dark-blue <strong>allocated</strong> memory, but check in with the instructor if you have questions about the free memory.</p>
<p>When you first start up the app, you should see that some memory has been allocated, but it shouldn’t be changing at all (since the <code>MainActivity</code> doesn’t create any new variables after it is created). But let’s change that!</p>
<p>While watching the monitor, click on the <strong>“BLANK ACTIVITY”</strong> button to be taken to a new (blank) Activity. <strong><em>Did you see the bar go up?!</em></strong> This is because opening a new Activity required allocating additional memory for that Activity (particularly its Views, since it doesn’t do much else).</p>
<ul>
<li>Of course, the bar didn’t go up by much; that’s because this simple Activity doesn’t require a lot of memory. In practice, even a lot of <code>Buttons</code> and <code>TextViews</code> don’t require large amounts of memory.</li>
</ul>
<p>Navigate back to the <code>MainActivity</code>. You might see the memory allocation increase a little more, as restarting the Activity can cause the Views to need to be recreated.</p>
<div id="garbage-collection" class="section level3">
<h3><span class="header-section-number">24.2.1</span> Garbage Collection</h3>
<p>Let’s see how the Java (technically, Dalvik) virtual machine handles memory. From the <code>MainActivity</code>, click on the button to go to the <code>ProgressActivity</code>. This Activity will show the progress towards completing a number of undefined tasks (it’s just showing a bunch of <code>ProgressBar</code> Views, which use a bit more memory than standard buttons).</p>
<ul>
<li>When you visited this <code>Activity</code>, you should have seen the memory allocation jump up!</li>
</ul>
<p>Now try navigating back and forth between the <code>MainActivity</code> and the <code>ProgressActivity</code>. You should see the allocated memory continue to increase (since we need to keep recreating those spinners), getting closer and closer to the amount of “free” memory. Eventually, Android will decide that it’s out of memory, and will initiate <strong>garbage collection</strong>, deallocating the memory that has previously been used to create the old spinners which are no longer needed (because that <em>instance</em> of the Activity is gone).</p>
<ul>
<li><p>Android will sometimes increase the amount of free memory available as the app asks for more. This is normal.</p></li>
<li><p>When the garbage collection occurs, you should see the amount of allocated memory suddenly drop. Those “cliffs” are the garbage collector running.</p></li>
</ul>
<p>There are actually different forms of garbage collection (which make different decisions about which values are “old enough” to be deallocated), and the one that you just triggered may not have collected everything. You can also use the memory monitor to <strong>manually</strong> initiate garbage collection—this is useful for checking if memory is <em>actually</em> being used, or just hasn’t been cleaned up yet.</p>
<ul>
<li><p>Manually initiate the garbage collection by clicking the <strong>“Initiate GC”</strong> button (<img src="img/memory/am-igc.png" title="From Google" alt="initiate GC" />) at the top of the memory monitor panel. <strong><em>What happens? Were there other values that could be cleaned up?</em></strong></p></li>
<li><p>Note that in practice, you should <strong>not</strong> try to perform garbage collection on your own—let the system do its own work (it is optimized to make sure that the computer doesn’t slow down too much when trying to do cleanup, which requires additional processing). This button is purely for testing and inspection.</p></li>
</ul>
</div>
</div>
<div id="memory-leaks" class="section level2">
<h2><span class="header-section-number">24.3</span> Memory Leaks</h2>
<p>Android’s garbage collection does a fine job of cleaning up memory… assuming that it can correctly identify the values that aren’t being used. This can sometimes be tricky: Java decides that a value is eligible for garbage collection whenever there are no longer any <em>references</em> to that value (e.g., no variables are in scope). However, if you’re not careful it’s often easy to leave an extra reference floating around that you didn’t intend, thereby keeping the memory from being deallocated. This is referred to as a <strong>memory leak</strong> (because the amount of available space is “leaking” away).</p>
<p>For example, consider the <code>BirdActivity</code> class, that you can view by clicking on the <strong>“BIRD ACTIVITY”</strong> button. This activity shows a relatively high-resolution image of a bird—when you open the Activity, you should see the amount of allocated memory jump up dramatically since we need to load that <code>Drawable</code> into memory.</p>
<p>If you click on the BirdActivity’s button, you’ll be taken to (another) blank Activity. Since the bird image is no longer being shown, it should no longer be used and thus should be eligible for garbage collection. Hit the “Initiate GC” button again to request that Android sweep up and reclaim that memory. <strong><em>What happens?</em></strong></p>
<p>You’ll notice that the large amount of memory allocated to the image doesn’t go away… it looks like the bird isn’t being garbage collected!</p>
<ul>
<li><p>Why not? Recall that when we start new Activities, old Activities are put on a <a href="https://developer.android.com/guide/components/activities/tasks-and-back-stack.html">back stack</a>, allowing us to be able to hit the “back” button and return to the previous Activity. This means that each Activity in the stack contains a reference to the previous ones… including the resources that they have loaded into memory! So there is in fact a reference to that image—it’s in the object that is stored on the backstack!</p></li>
<li><p>This can be a problem. It means that because we have that history, the amount of memory available to our application is smaller even though we’re not actually looking at the pretty bird right now.</p></li>
</ul>
<p>We can fix this by utilizing the <code>Activity</code> lifecycle callbacks. Specifically, you can remove the reference to the image when the the <code>Activity</code> <strong>stops</strong>, and then reload the image when the <code>Activity</code> <strong>starts</strong> again.</p>
<ul>
<li><p><strong><em>For practice</em></strong>, in the <code>BirdActivity</code>, override the <code>onStop()</code> method. Inside this method, set the <code>ImageView</code>’s drawable to be <code>null</code>.</p></li>
<li><p>Similarly, override the the <code>onStart()</code> method so it loads and displays the image when the <code>Activity</code> is (re)started. You can just move the relevant code from <code>onCreate()</code>.</p></li>
</ul>
<p>Once you’ve done this, try navigating to the <code>BirdActivity</code> and clicking the button to go to the <code>BlankBirdActivity</code>. Use the “Initiate GC” button to force a garbage collection sweep—<strong><em>does the image’s memory get cleaned up now?</em></strong></p>
<ul>
<li>While this does mean that we’re not using as much memory when the <code>Activity</code> isn’t shown, it does mean that returning to the <code>Activity</code> is <em>slightly</em> slower (since we need to reload the image). This is the fundamental trade-off in all of programming optimization: <em>use of space vs. use of time</em>.</li>
</ul>
<p>Now you should have a sense for how values in Android can influence memory usage. The main take-away is that you want to be careful to de-reference any object that take significant memory (like images or other media; this is why we released the <code>MediaPlayer</code> when discussing Services).</p>
<ul>
<li>Additionally: note that <code>static</code> variables are <em>never</em> de-referenced and so are <em>never</em> garbage-collected. Thus you want to avoid <code>static</code> variables for anything more complex than a <code>String</code> to avoid more memory leaks!</li>
</ul>
<p>Finally, if you use the memory monitor and see memory usage stacking up, that is not necessarily a memory leak or other problem: it could just be that the system hasn’t run garbage collection yet! A memory leak is when resources that <em>should</em> be able to be reclaimed cannot be—but as long as you keep variables local and de-reference large objects, you’ll be fine!</p>
<p class="alert alert-info">
Android Studio includes numerous other monitors for profiling the performance of your application. See <a href="https://developer.android.com/studio/profile/android-monitor.html">Android Monitor</a> and <a href="https://developer.android.com/topic/performance/index.html">Performance and Power</a> for more details.
</p>
<p class="alert alert-warning">
Avoid pre-mature optimization! Make sure that you can get your app <em>working</em> first, and then utilize these tools to solve specific problems, such as slow performance.
</p>

</div>
</div>



</div>
            </section>

          </div>
        </div>
      </div>
<a href="multi-touch.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="java-review.html" class="navigation navigation-next " aria-label="Next page""><i class="fa fa-angle-right"></i></a>

<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": false,
"google": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["github", "facebook", "twitter", "google"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/info448-s17/lecture-notes/edit/master/memory.Rmd",
"text": "Edit"
},
"download": ["android-dev-book.pdf", "android-dev-book.epub"],
"toc": {
"collapse": "section",
"scroll_highlight": true
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    if (location.protocol !== "file:" && /^https?:/.test(script.src))
      script.src  = script.src.replace(/^https?:/, '');
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
