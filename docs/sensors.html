<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Android Development: Lecture Notes</title>
  <meta content="text/html; charset=UTF-8" http-equiv="Content-Type">
  <meta name="description" content="Lecture notes for Info 448 Mobile Development: Android.">
  <meta name="generator" content="bookdown 0.3 and GitBook 2.6.7">

  <meta property="og:title" content="Android Development: Lecture Notes" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Lecture notes for Info 448 Mobile Development: Android." />
  <meta name="github-repo" content="info448-s17/lecture-notes" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Android Development: Lecture Notes" />
  
  <meta name="twitter:description" content="Lecture notes for Info 448 Mobile Development: Android." />
  

<meta name="author" content="Joel Ross">


<meta name="date" content="2017-05-03">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="location.html">
<link rel="next" href="publishing.html">

<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />







<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-98444716-1', 'auto');
  ga('send', 'pageview');

</script>


<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="css/style.css" type="text/css" />
</head>

<body>


  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Android Development</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>About this Book</a></li>
<li class="part"><span><b>I Lectures</b></span></li>
<li class="chapter" data-level="1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>1</b> Introduction</a><ul>
<li class="chapter" data-level="1.1" data-path="introduction.html"><a href="introduction.html#android-history"><i class="fa fa-check"></i><b>1.1</b> Android History</a><ul>
<li class="chapter" data-level="1.1.1" data-path="introduction.html"><a href="introduction.html#android-versions"><i class="fa fa-check"></i><b>1.1.1</b> Android Versions</a></li>
<li class="chapter" data-level="1.1.2" data-path="introduction.html"><a href="introduction.html#legal-battles"><i class="fa fa-check"></i><b>1.1.2</b> Legal Battles</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="introduction.html"><a href="introduction.html#android-architecture-and-code"><i class="fa fa-check"></i><b>1.2</b> Android Architecture and Code</a><ul>
<li class="chapter" data-level="1.2.1" data-path="introduction.html"><a href="introduction.html#programming-languages"><i class="fa fa-check"></i><b>1.2.1</b> Programming Languages</a></li>
<li class="chapter" data-level="1.2.2" data-path="introduction.html"><a href="introduction.html#building-apps"><i class="fa fa-check"></i><b>1.2.2</b> Building Apps</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="introduction.html"><a href="introduction.html#development-tools"><i class="fa fa-check"></i><b>1.3</b> Development Tools</a><ul>
<li class="chapter" data-level="1.3.1" data-path="introduction.html"><a href="introduction.html#hardware"><i class="fa fa-check"></i><b>1.3.1</b> Hardware</a></li>
<li class="chapter" data-level="1.3.2" data-path="introduction.html"><a href="introduction.html#software"><i class="fa fa-check"></i><b>1.3.2</b> Software</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="introduction.html"><a href="introduction.html#hello-world"><i class="fa fa-check"></i><b>1.4</b> Hello World</a><ul>
<li class="chapter" data-level="1.4.1" data-path="introduction.html"><a href="introduction.html#the-emulator"><i class="fa fa-check"></i><b>1.4.1</b> The Emulator</a></li>
<li class="chapter" data-level="1.4.2" data-path="introduction.html"><a href="introduction.html#project-contents"><i class="fa fa-check"></i><b>1.4.2</b> Project Contents</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="activities.html"><a href="activities.html"><i class="fa fa-check"></i><b>2</b> Activities and Logging</a><ul>
<li class="chapter" data-level="2.1" data-path="activities.html"><a href="activities.html#making-activities"><i class="fa fa-check"></i><b>2.1</b> Making Activities</a></li>
<li class="chapter" data-level="2.2" data-path="activities.html"><a href="activities.html#the-activity-lifecycle"><i class="fa fa-check"></i><b>2.2</b> The Activity Lifecycle</a><ul>
<li class="chapter" data-level="2.2.1" data-path="activities.html"><a href="activities.html#overriding-the-callback-methods"><i class="fa fa-check"></i><b>2.2.1</b> Overriding the Callback Methods</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="activities.html"><a href="activities.html#logging-adb"><i class="fa fa-check"></i><b>2.3</b> Logging &amp; ADB</a><ul>
<li class="chapter" data-level="2.3.1" data-path="activities.html"><a href="activities.html#log-methods"><i class="fa fa-check"></i><b>2.3.1</b> Log Methods</a></li>
<li class="chapter" data-level="2.3.2" data-path="activities.html"><a href="activities.html#logcat"><i class="fa fa-check"></i><b>2.3.2</b> Logcat</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="activities.html"><a href="activities.html#basic-events"><i class="fa fa-check"></i><b>2.4</b> Basic Events</a></li>
<li class="chapter" data-level="2.5" data-path="activities.html"><a href="activities.html#multiple-activities"><i class="fa fa-check"></i><b>2.5</b> Multiple Activities</a><ul>
<li class="chapter" data-level="2.5.1" data-path="activities.html"><a href="activities.html#intents-and-context"><i class="fa fa-check"></i><b>2.5.1</b> Intents and Context</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="activities.html"><a href="activities.html#back-tasks"><i class="fa fa-check"></i><b>2.6</b> Back &amp; Tasks</a><ul>
<li class="chapter" data-level="2.6.1" data-path="activities.html"><a href="activities.html#up-navigation"><i class="fa fa-check"></i><b>2.6.1</b> Up Navigation</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="resources-and-layouts.html"><a href="resources-and-layouts.html"><i class="fa fa-check"></i><b>3</b> Resources and Layouts</a><ul>
<li class="chapter" data-level="3.1" data-path="resources-and-layouts.html"><a href="resources-and-layouts.html#resources"><i class="fa fa-check"></i><b>3.1</b> Resources</a><ul>
<li class="chapter" data-level="3.1.1" data-path="resources-and-layouts.html"><a href="resources-and-layouts.html#alternative-resources"><i class="fa fa-check"></i><b>3.1.1</b> Alternate Resources</a></li>
<li class="chapter" data-level="3.1.2" data-path="resources-and-layouts.html"><a href="resources-and-layouts.html#xml-details"><i class="fa fa-check"></i><b>3.1.2</b> XML Details</a></li>
<li class="chapter" data-level="3.1.3" data-path="resources-and-layouts.html"><a href="resources-and-layouts.html#r"><i class="fa fa-check"></i><b>3.1.3</b> R</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="resources-and-layouts.html"><a href="resources-and-layouts.html#views"><i class="fa fa-check"></i><b>3.2</b> Views</a><ul>
<li class="chapter" data-level="3.2.1" data-path="resources-and-layouts.html"><a href="resources-and-layouts.html#view-properties"><i class="fa fa-check"></i><b>3.2.1</b> View Properties</a></li>
<li class="chapter" data-level="3.2.2" data-path="resources-and-layouts.html"><a href="resources-and-layouts.html#practice"><i class="fa fa-check"></i><b>3.2.2</b> Practice</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="resources-and-layouts.html"><a href="resources-and-layouts.html#layouts"><i class="fa fa-check"></i><b>3.3</b> Layouts</a><ul>
<li class="chapter" data-level="3.3.1" data-path="resources-and-layouts.html"><a href="resources-and-layouts.html#linearlayout"><i class="fa fa-check"></i><b>3.3.1</b> LinearLayout</a></li>
<li class="chapter" data-level="3.3.2" data-path="resources-and-layouts.html"><a href="resources-and-layouts.html#relativelayout"><i class="fa fa-check"></i><b>3.3.2</b> RelativeLayout</a></li>
<li class="chapter" data-level="3.3.3" data-path="resources-and-layouts.html"><a href="resources-and-layouts.html#constraintlayout"><i class="fa fa-check"></i><b>3.3.3</b> ConstraintLayout</a></li>
<li class="chapter" data-level="3.3.4" data-path="resources-and-layouts.html"><a href="resources-and-layouts.html#other-layouts"><i class="fa fa-check"></i><b>3.3.4</b> Other Layouts</a></li>
<li class="chapter" data-level="3.3.5" data-path="resources-and-layouts.html"><a href="resources-and-layouts.html#combining-and-inflating-layouts"><i class="fa fa-check"></i><b>3.3.5</b> Combining and Inflating Layouts</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="interactive-views.html"><a href="interactive-views.html"><i class="fa fa-check"></i><b>4</b> Interactive Views</a><ul>
<li class="chapter" data-level="4.1" data-path="interactive-views.html"><a href="interactive-views.html#inputs"><i class="fa fa-check"></i><b>4.1</b> Inputs</a></li>
<li class="chapter" data-level="4.2" data-path="interactive-views.html"><a href="interactive-views.html#listviews-and-adapters"><i class="fa fa-check"></i><b>4.2</b> ListViews and Adapters</a></li>
<li class="chapter" data-level="4.3" data-path="interactive-views.html"><a href="interactive-views.html#network-data"><i class="fa fa-check"></i><b>4.3</b> Network Data</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="fragments.html"><a href="fragments.html"><i class="fa fa-check"></i><b>5</b> Fragments</a><ul>
<li class="chapter" data-level="5.1" data-path="fragments.html"><a href="fragments.html#creating-a-fragment"><i class="fa fa-check"></i><b>5.1</b> Creating a Fragment</a><ul>
<li class="chapter" data-level="5.1.1" data-path="fragments.html"><a href="fragments.html#activity-to-fragment-communication"><i class="fa fa-check"></i><b>5.1.1</b> Activity-to-Fragment Communication</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="fragments.html"><a href="fragments.html#dynamic-fragments"><i class="fa fa-check"></i><b>5.2</b> Dynamic Fragments</a><ul>
<li class="chapter" data-level="5.2.1" data-path="fragments.html"><a href="fragments.html#instantiating-fragments"><i class="fa fa-check"></i><b>5.2.1</b> Instantiating Fragments</a></li>
<li class="chapter" data-level="5.2.2" data-path="fragments.html"><a href="fragments.html#transactions"><i class="fa fa-check"></i><b>5.2.2</b> Transactions</a></li>
<li class="chapter" data-level="5.2.3" data-path="fragments.html"><a href="fragments.html#inter-fragment-communication"><i class="fa fa-check"></i><b>5.2.3</b> Inter-Fragment Communication</a></li>
<li class="chapter" data-level="5.2.4" data-path="fragments.html"><a href="fragments.html#the-back-stack"><i class="fa fa-check"></i><b>5.2.4</b> The Back Stack</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="ui-components.html"><a href="ui-components.html"><i class="fa fa-check"></i><b>6</b> UI Components</a><ul>
<li class="chapter" data-level="6.1" data-path="ui-components.html"><a href="ui-components.html#the-action-bar"><i class="fa fa-check"></i><b>6.1</b> The Action Bar</a></li>
<li class="chapter" data-level="6.2" data-path="ui-components.html"><a href="ui-components.html#menus"><i class="fa fa-check"></i><b>6.2</b> Menus</a><ul>
<li class="chapter" data-level="6.2.1" data-path="ui-components.html"><a href="ui-components.html#context-menus"><i class="fa fa-check"></i><b>6.2.1</b> Context Menus</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="ui-components.html"><a href="ui-components.html#dialogs"><i class="fa fa-check"></i><b>6.3</b> Dialogs</a><ul>
<li class="chapter" data-level="6.3.1" data-path="ui-components.html"><a href="ui-components.html#dialogfragments"><i class="fa fa-check"></i><b>6.3.1</b> DialogFragments</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="ui-components.html"><a href="ui-components.html#toasts"><i class="fa fa-check"></i><b>6.4</b> Toasts</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="providers-and-loaders.html"><a href="providers-and-loaders.html"><i class="fa fa-check"></i><b>7</b> Providers and Loaders</a><ul>
<li class="chapter" data-level="7.1" data-path="providers-and-loaders.html"><a href="providers-and-loaders.html#content-providers"><i class="fa fa-check"></i><b>7.1</b> Content Providers</a></li>
<li class="chapter" data-level="7.2" data-path="providers-and-loaders.html"><a href="providers-and-loaders.html#cursors"><i class="fa fa-check"></i><b>7.2</b> Cursors</a></li>
<li class="chapter" data-level="7.3" data-path="providers-and-loaders.html"><a href="providers-and-loaders.html#loaders"><i class="fa fa-check"></i><b>7.3</b> Loaders</a></li>
<li class="chapter" data-level="7.4" data-path="providers-and-loaders.html"><a href="providers-and-loaders.html#other-provider-actions"><i class="fa fa-check"></i><b>7.4</b> Other Provider Actions</a><ul>
<li class="chapter" data-level="7.4.1" data-path="providers-and-loaders.html"><a href="providers-and-loaders.html#adding-words"><i class="fa fa-check"></i><b>7.4.1</b> Adding Words</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="intents.html"><a href="intents.html"><i class="fa fa-check"></i><b>8</b> Intents</a><ul>
<li class="chapter" data-level="8.1" data-path="intents.html"><a href="intents.html#intents-for-another-activity-explicit"><i class="fa fa-check"></i><b>8.1</b> Intents for Another Activity (Explicit)</a><ul>
<li class="chapter" data-level="8.1.1" data-path="intents.html"><a href="intents.html#extras"><i class="fa fa-check"></i><b>8.1.1</b> Extras</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="intents.html"><a href="intents.html#intents-for-another-app-implicit"><i class="fa fa-check"></i><b>8.2</b> Intents for Another App (Implicit)</a></li>
<li class="chapter" data-level="8.3" data-path="intents.html"><a href="intents.html#intents-for-a-response"><i class="fa fa-check"></i><b>8.3</b> Intents for a Response</a></li>
<li class="chapter" data-level="8.4" data-path="intents.html"><a href="intents.html#listening-for-intents"><i class="fa fa-check"></i><b>8.4</b> Listening for Intents</a></li>
<li class="chapter" data-level="8.5" data-path="intents.html"><a href="intents.html#broadcasts-and-receivers"><i class="fa fa-check"></i><b>8.5</b> Broadcasts and Receivers</a></li>
<li class="chapter" data-level="8.6" data-path="intents.html"><a href="intents.html#an-example-sms"><i class="fa fa-check"></i><b>8.6</b> An Example: SMS</a></li>
<li class="chapter" data-level="8.7" data-path="intents.html"><a href="intents.html#shareactionprovider"><i class="fa fa-check"></i><b>8.7</b> ShareActionProvider</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="ui-components-ii.html"><a href="ui-components-ii.html"><i class="fa fa-check"></i><b>9</b> UI Components II</a><ul>
<li class="chapter" data-level="9.1" data-path="ui-components-ii.html"><a href="ui-components-ii.html#notifications"><i class="fa fa-check"></i><b>9.1</b> Notifications</a></li>
<li class="chapter" data-level="9.2" data-path="ui-components-ii.html"><a href="ui-components-ii.html#settings"><i class="fa fa-check"></i><b>9.2</b> Settings</a><ul>
<li class="chapter" data-level="9.2.1" data-path="ui-components-ii.html"><a href="ui-components-ii.html#sharedpreferences"><i class="fa fa-check"></i><b>9.2.1</b> SharedPreferences</a></li>
<li class="chapter" data-level="9.2.2" data-path="ui-components-ii.html"><a href="ui-components-ii.html#preference-settings"><i class="fa fa-check"></i><b>9.2.2</b> Preference Settings</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="files-and-permissions.html"><a href="files-and-permissions.html"><i class="fa fa-check"></i><b>10</b> Files and Permissions</a><ul>
<li class="chapter" data-level="10.1" data-path="files-and-permissions.html"><a href="files-and-permissions.html#file-storage-locations"><i class="fa fa-check"></i><b>10.1</b> File Storage Locations</a></li>
<li class="chapter" data-level="10.2" data-path="files-and-permissions.html"><a href="files-and-permissions.html#permissions"><i class="fa fa-check"></i><b>10.2</b> Permissions</a></li>
<li class="chapter" data-level="10.3" data-path="files-and-permissions.html"><a href="files-and-permissions.html#external-storage"><i class="fa fa-check"></i><b>10.3</b> External Storage</a></li>
<li class="chapter" data-level="10.4" data-path="files-and-permissions.html"><a href="files-and-permissions.html#internal-storage-cache"><i class="fa fa-check"></i><b>10.4</b> Internal Storage &amp; Cache</a></li>
<li class="chapter" data-level="10.5" data-path="files-and-permissions.html"><a href="files-and-permissions.html#example-saving-pictures"><i class="fa fa-check"></i><b>10.5</b> Example: Saving Pictures</a></li>
<li class="chapter" data-level="10.6" data-path="files-and-permissions.html"><a href="files-and-permissions.html#sharing-files"><i class="fa fa-check"></i><b>10.6</b> Sharing Files</a><ul>
<li class="chapter" data-level="10.6.1" data-path="files-and-permissions.html"><a href="files-and-permissions.html#bonus-sharing-with-a-fileprovider"><i class="fa fa-check"></i><b>10.6.1</b> Bonus: Sharing with a <code>FileProvider</code></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="location.html"><a href="location.html"><i class="fa fa-check"></i><b>11</b> Location</a><ul>
<li class="chapter" data-level="11.1" data-path="location.html"><a href="location.html#localization-techniques"><i class="fa fa-check"></i><b>11.1</b> Localization Techniques</a><ul>
<li class="chapter" data-level="11.1.1" data-path="location.html"><a href="location.html#gps"><i class="fa fa-check"></i><b>11.1.1</b> GPS</a></li>
<li class="chapter" data-level="11.1.2" data-path="location.html"><a href="location.html#cell-tower-localization"><i class="fa fa-check"></i><b>11.1.2</b> Cell Tower Localization</a></li>
<li class="chapter" data-level="11.1.3" data-path="location.html"><a href="location.html#wifi-localization"><i class="fa fa-check"></i><b>11.1.3</b> WiFi Localization</a></li>
<li class="chapter" data-level="11.1.4" data-path="location.html"><a href="location.html#representing-location"><i class="fa fa-check"></i><b>11.1.4</b> Representing Location</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="location.html"><a href="location.html#android-location"><i class="fa fa-check"></i><b>11.2</b> Android Location</a><ul>
<li class="chapter" data-level="11.2.1" data-path="location.html"><a href="location.html#google-play-services"><i class="fa fa-check"></i><b>11.2.1</b> Google Play Services</a></li>
<li class="chapter" data-level="11.2.2" data-path="location.html"><a href="location.html#accessing-location"><i class="fa fa-check"></i><b>11.2.2</b> Accessing Location</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="sensors.html"><a href="sensors.html"><i class="fa fa-check"></i><b>12</b> Sensors</a><ul>
<li class="chapter" data-level="12.1" data-path="sensors.html"><a href="sensors.html#motion-sensors"><i class="fa fa-check"></i><b>12.1</b> Motion Sensors</a><ul>
<li class="chapter" data-level="12.1.1" data-path="sensors.html"><a href="sensors.html#accessing-sensors"><i class="fa fa-check"></i><b>12.1.1</b> Accessing Sensors</a></li>
<li class="chapter" data-level="12.1.2" data-path="sensors.html"><a href="sensors.html#composite-sensors"><i class="fa fa-check"></i><b>12.1.2</b> Composite Sensors</a></li>
</ul></li>
<li class="chapter" data-level="12.2" data-path="sensors.html"><a href="sensors.html#rotation"><i class="fa fa-check"></i><b>12.2</b> Rotation</a><ul>
<li class="chapter" data-level="12.2.1" data-path="sensors.html"><a href="sensors.html#coordinates"><i class="fa fa-check"></i><b>12.2.1</b> Coordinates</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="13" data-path="publishing.html"><a href="publishing.html"><i class="fa fa-check"></i><b>13</b> Publishing</a><ul>
<li class="chapter" data-level="13.1" data-path="publishing.html"><a href="publishing.html#signing-an-app"><i class="fa fa-check"></i><b>13.1</b> Signing an App</a><ul>
<li class="chapter" data-level="13.1.1" data-path="publishing.html"><a href="publishing.html#a-release-.apk"><i class="fa fa-check"></i><b>13.1.1</b> A Release <code>.apk</code></a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>II Additional Topics (Labs)</b></span></li>
<li class="chapter" data-level="14" data-path="accessibility.html"><a href="accessibility.html"><i class="fa fa-check"></i><b>14</b> Accessibility</a><ul>
<li class="chapter" data-level="14.1" data-path="accessibility.html"><a href="accessibility.html#universal-usability"><i class="fa fa-check"></i><b>14.1</b> Universal Usability</a></li>
<li class="chapter" data-level="14.2" data-path="accessibility.html"><a href="accessibility.html#implementing-accessibility"><i class="fa fa-check"></i><b>14.2</b> Implementing Accessibility</a><ul>
<li class="chapter" data-level="14.2.1" data-path="accessibility.html"><a href="accessibility.html#supporting-vision-impairment"><i class="fa fa-check"></i><b>14.2.1</b> Supporting Vision Impairment</a></li>
<li class="chapter" data-level="14.2.2" data-path="accessibility.html"><a href="accessibility.html#supporting-alternative-inputs"><i class="fa fa-check"></i><b>14.2.2</b> Supporting Alternative Inputs</a></li>
<li class="chapter" data-level="14.2.3" data-path="accessibility.html"><a href="accessibility.html#supporting-internationalization"><i class="fa fa-check"></i><b>14.2.3</b> Supporting Internationalization</a></li>
<li class="chapter" data-level="14.2.4" data-path="accessibility.html"><a href="accessibility.html#further-testing"><i class="fa fa-check"></i><b>14.2.4</b> Further Testing</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="15" data-path="fragments-viewpager.html"><a href="fragments-viewpager.html"><i class="fa fa-check"></i><b>15</b> Fragments: ViewPager</a><ul>
<li class="chapter" data-level="15.1" data-path="fragments-viewpager.html"><a href="fragments-viewpager.html#define-a-searchfragment"><i class="fa fa-check"></i><b>15.1</b> Define a SearchFragment</a></li>
<li class="chapter" data-level="15.2" data-path="fragments-viewpager.html"><a href="fragments-viewpager.html#add-the-viewpager-and-adapter"><i class="fa fa-check"></i><b>15.2</b> Add the ViewPager and Adapter</a></li>
<li class="chapter" data-level="15.3" data-path="fragments-viewpager.html"><a href="fragments-viewpager.html#add-user-interaction"><i class="fa fa-check"></i><b>15.3</b> Add User Interaction</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="bluetooth.html"><a href="bluetooth.html"><i class="fa fa-check"></i><b>16</b> Bluetooth</a></li>
<li class="chapter" data-level="17" data-path="maps.html"><a href="maps.html"><i class="fa fa-check"></i><b>17</b> Maps</a><ul>
<li class="chapter" data-level="17.1" data-path="maps.html"><a href="maps.html#create-a-map-activity"><i class="fa fa-check"></i><b>17.1</b> Create a Map Activity</a><ul>
<li class="chapter" data-level="17.1.1" data-path="maps.html"><a href="maps.html#getting-an-api-key"><i class="fa fa-check"></i><b>17.1.1</b> Getting an API Key</a></li>
<li class="chapter" data-level="17.1.2" data-path="maps.html"><a href="maps.html#the-supportmapfragment"><i class="fa fa-check"></i><b>17.1.2</b> The <code>SupportMapFragment</code></a></li>
</ul></li>
<li class="chapter" data-level="17.2" data-path="maps.html"><a href="maps.html#specifying-the-user-interface"><i class="fa fa-check"></i><b>17.2</b> Specifying the User Interface</a></li>
<li class="chapter" data-level="17.3" data-path="maps.html"><a href="maps.html#markers-and-drawings"><i class="fa fa-check"></i><b>17.3</b> Markers and Drawings</a><ul>
<li class="chapter" data-level="17.3.1" data-path="maps.html"><a href="maps.html#drawing-shapes"><i class="fa fa-check"></i><b>17.3.1</b> Drawing Shapes</a></li>
</ul></li>
</ul></li>
<li class="appendix"><span><b>Appendix: Java</b></span></li>
<li class="chapter" data-level="A" data-path="java-review.html"><a href="java-review.html"><i class="fa fa-check"></i><b>A</b> Java Review</a><ul>
<li class="chapter" data-level="A.1" data-path="java-review.html"><a href="java-review.html#building-apps-with-gradle"><i class="fa fa-check"></i><b>A.1</b> Building Apps with Gradle</a></li>
<li class="chapter" data-level="A.2" data-path="java-review.html"><a href="java-review.html#class-basics"><i class="fa fa-check"></i><b>A.2</b> Class Basics</a></li>
<li class="chapter" data-level="A.3" data-path="java-review.html"><a href="java-review.html#inheritance"><i class="fa fa-check"></i><b>A.3</b> Inheritance</a></li>
<li class="chapter" data-level="A.4" data-path="java-review.html"><a href="java-review.html#interfaces"><i class="fa fa-check"></i><b>A.4</b> Interfaces</a></li>
<li class="chapter" data-level="A.5" data-path="java-review.html"><a href="java-review.html#polymorphism"><i class="fa fa-check"></i><b>A.5</b> Polymorphism</a></li>
<li class="chapter" data-level="A.6" data-path="java-review.html"><a href="java-review.html#abstract-methods-and-classes"><i class="fa fa-check"></i><b>A.6</b> Abstract Methods and Classes</a></li>
<li class="chapter" data-level="A.7" data-path="java-review.html"><a href="java-review.html#generics"><i class="fa fa-check"></i><b>A.7</b> Generics</a></li>
<li class="chapter" data-level="A.8" data-path="java-review.html"><a href="java-review.html#nested-classes"><i class="fa fa-check"></i><b>A.8</b> Nested Classes</a></li>
</ul></li>
<li class="chapter" data-level="B" data-path="java-swing.html"><a href="java-swing.html"><i class="fa fa-check"></i><b>B</b> Swing Framework</a><ul>
<li class="chapter" data-level="B.1" data-path="java-swing.html"><a href="java-swing.html#events"><i class="fa fa-check"></i><b>B.1</b> Events</a></li>
<li class="chapter" data-level="B.2" data-path="java-swing.html"><a href="java-swing.html#layouts-and-composites"><i class="fa fa-check"></i><b>B.2</b> Layouts and Composites</a></li>
</ul></li>
<li class="chapter" data-level="C" data-path="java-threads-http.html"><a href="java-threads-http.html"><i class="fa fa-check"></i><b>C</b> Threads and HTTP Requests</a><ul>
<li class="chapter" data-level="C.1" data-path="java-threads-http.html"><a href="java-threads-http.html#concurrency"><i class="fa fa-check"></i><b>C.1</b> Concurrency</a><ul>
<li class="chapter" data-level="C.1.1" data-path="java-threads-http.html"><a href="java-threads-http.html#an-example-algorithm-races"><i class="fa fa-check"></i><b>C.1.1</b> An Example: Algorithm Races!</a></li>
<li class="chapter" data-level="C.1.2" data-path="java-threads-http.html"><a href="java-threads-http.html#threading-the-race"><i class="fa fa-check"></i><b>C.1.2</b> Threading the Race</a></li>
</ul></li>
<li class="chapter" data-level="C.2" data-path="java-threads-http.html"><a href="java-threads-http.html#http-requests"><i class="fa fa-check"></i><b>C.2</b> HTTP Requests</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Android Development: Lecture Notes</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="sensors" class="section level1">
<h1><span class="header-section-number">Lecture 12</span> Sensors</h1>
<p>This lecture discusses how to access and utilize hardware <a href="https://developer.android.com/guide/topics/sensors/sensors_overview.html"><strong>sensors</strong></a> built into Android devices. These sensors can be used to detect changes to the device (such as it’s <em>motion</em> via the <strong>accelerometer</strong>) or its surrounding environment (such as the weather via a <strong>thermometer</strong> or <strong>barameter</strong>). Additionally, the system is structured so you can develop and connect your own sensor hardware if needed—such as connecting to a medical device or some other kind of <a href="https://arstechnica.com/science/2017/04/underdog-team-wins-millions-in-competition-to-make-real-life-tricorder/">tricorder</a>.</p>
<p class="alert alert-info">
This lecture references code found at <a href="https://github.com/info448-s17/lecture12-sensors" class="uri">https://github.com/info448-s17/lecture12-sensors</a>.
</p>
<div id="motion-sensors" class="section level2">
<h2><span class="header-section-number">12.1</span> Motion Sensors</h2>
<p>To continue to emphasize to <em>mobility</em> of Android devices (they can be picked up and moved, shook around, tossed in the air, etc.), this lecture will demonstrate how to use <strong>motion sensors</strong> to detect how an Android device is able to measure its movement. Nevetheless, Android does provide a general <em>framework</em> for interacting with any arbitrary sensor (whether built into the device or external to it); motion sensors are just one example.</p>
<ul>
<li>There are <a href="https://source.android.com/devices/sensors/sensor-types">many differents sensor types</a><a href="#fn37" class="footnoteRef" id="fnref37"><sup>37</sup></a> defined by the Android framework. The interfaces for these sensors are defined by the Android Alliance rather than Google, since the interface needs to exist between hardware and software (so multiple stakeholders are involved).</li>
</ul>
<p>In particular, we’ll focus on using the <a href="https://developer.android.com/guide/topics/sensors/sensors_motion.html#sensors-motion-accel"><strong>accelerometer</strong></a>, which is used to detect <em>acceleration force</em> (e.g., how fast the device is moving in some direction). This sensor is found on most devices, and has the added benefit of being a relatively “low-powered” sensor—its ubiquity and low cost of usage makes it ideal for detecting motions!</p>
<p>The accelerometer is an example of a <a href="http://developer.android.com/guide/topics/sensors/sensors_motion.html"><em>motion sensor</em></a>, which are used to detect how the device <em>moves</em> in space: tilting, shaking, rotating, or swinging. Motion sensors are related to but different from <a href="http://developer.android.com/guide/topics/sensors/sensors_position.html"><em>position sensors</em></a> which determine where the device <em>is</em> in space: for example, the device’s current rotation, facing, or proximity to another object (e.g., someone’s face). Position sensors different from location sensors (like GPS), in that they measure position relative to the device rather than relative to the world.</p>
<ul>
<li>It is also possible to detect motion using a <em>gravity sensor</em> (which measures the direction of gravity relative to the device), a <em>gyroscope</em> (measures the rate of spin of the device), or a number of other sensors. However, the accelerometer is the most common and can be used in combination with other sensors as needed.</li>
</ul>
<p>We do not need any special permissions to access the accelerometer. But because our app will rely on a certain piece of hardware that—while common—may not be present on very device, we will want to make sure that anyone installing our app (e.g., from the Play Store) has that hardware. We can specify this requirement in the <code>Manifest</code> with a <code>&lt;uses-feature&gt;</code> element:</p>
<div class="sourceCode"><pre class="sourceCode xml"><code class="sourceCode xml"><span class="kw">&lt;uses-feature</span><span class="ot"> android:name=</span><span class="st">&quot;android.hardware.sensor.accelerometer&quot;</span>
<span class="ot">              android:required=</span><span class="st">&quot;true&quot;</span> <span class="kw">/&gt;</span></code></pre></div>
<ul>
<li>This declaration doesn’t actually prevent the user from installing the app, though it will cause the Play Store to list it as “incompatible”. Effectively, it’s just an extra note.</li>
</ul>
<div id="accessing-sensors" class="section level3">
<h3><span class="header-section-number">12.1.1</span> Accessing Sensors</h3>
<p>In Android, we start working with sensors by using the <a href="https://developer.android.com/reference/android/hardware/SensorManager.html"><code>SensorManager</code></a><a href="#fn38" class="footnoteRef" id="fnref38"><sup>38</sup></a> class, which will tell us information about what sensors are available, as well as let us register listeners to record sensor readings. The class is actually a <em>service</em> (an application that runs in the background) which manages all of the external sensors—very similar to the <code>NotificationManager</code> used to track all of the system notifications. We can get a reference to the SensorManager object using:</p>
<div class="sourceCode"><pre class="sourceCode java"><code class="sourceCode java">mSensorManager = (SensorManager)<span class="fu">getSystemService</span>(<span class="bu">Context</span>.<span class="fu">SENSOR_SERVICE</span>);</code></pre></div>
<ul>
<li>Just like how we accessed the Notification Service, we ask the Android System to “get” us a reference to the Sensor Service, which <em>is</em> a <code>SensorManager</code>.</li>
</ul>
<p>The <code>SensorManager</code> class provides a number of useful methods. For example, the <code>SensorManager#getSensorList(type)</code> method will return a list of sensors available to the device (the argument is the “type” of sensor to list; use <code>Sensor.TYPE_ALL</code> to see all sensors). The sensors are returned as a <code>List&lt;Sensor&gt;</code>—each <a href="https://developer.android.com/reference/android/hardware/Sensor.html"><code>Sensor</code></a><a href="#fn39" class="footnoteRef" id="fnref39"><sup>39</sup></a> object represents a particular sensor. The <code>Sensor</code> class includes information like the sensor type (which is <em>not</em> represented via subclassing, because otherwise we couldn’t easily add our own types! Composition over inheritance).</p>
<p>Devices may have multiple sensors of the same type; in order to access the “main” sensor, we use the <code>SensorManager#getDefaultSensor(type)</code> method. This method will return <code>null</code> if there is no sensor of that type (allowing us to check if the sensor even exists), or the “default” <code>Sensor</code> object of that type (as determined by the OS and manufacturer).</p>
<ul>
<li>If no valid sensor is available, we can have the Activity close on its own by calling <code>finish()</code> on it.</li>
</ul>
<p>In order to get readings from the sensor, we need to <em>register a listener</em> for the event that occurs when a sensor sample is available. We can do this using the SensorManager:</p>
<div class="sourceCode"><pre class="sourceCode java"><code class="sourceCode java">mSensorManager.<span class="fu">registerListener</span>(<span class="kw">this</span>, mSensor, SensorManager.<span class="fu">SENSOR_DELAY_NORMAL</span>);</code></pre></div>
<ul>
<li><p>The first parameter is a <code>SensorEventListener</code>, which will handle the callbacks when a <code>SensorEvent</code> (a reading) is produced. It is common to make the containing Activity the listener, and thus have it implement the interface and its two callbacks (described below).</p></li>
<li><p>The second parameter is the sensor to listen to, and the third parameter is a flag indicating how often to sample the environment. <code>SENSOR_DELAY_NORMAL</code> corresponds to a 200,000 microsecond (200ms) delay between samples; use <code>SENSOR_DELAY_GAME</code> for a faster 20ms delay (e.g., if making a motion-based game).</p></li>
<li><p><strong>Important</strong> be sure to <em>unregister</em> the listener in the Activity’s <code>onPause()</code> callback in order to “turn off” the sensor when it is not directly being used. Sensors can cause significant battery drain (even though the accelerometer is on the low end of that), so it is best to minimize that. Equivalently, you can register the sensor in the <code>onResume()</code> function to have it start back up.</p></li>
</ul>
<p>We can utilize the sampled sensor information by filling in the <code>onSensorChanged(event)</code> callback. This callback is exected <em>whenever</em> a new sensor reading occurs (so possibly 50 times a second)! The <code>onAccuracyChanged()</code> method is used to handle when the sensor switches modes in some way; we will leave that blank for now.</p>
<p>In the <code>onSensorChanged()</code> method, sensor readings are stored in the <code>event.values</code> variable. This variable is an array of <code>floats</code>, but the size of the array and the meaning/range of the values in that array are entirely depending on the sensor type that produced the event (which can be determined via the <code>event.sensor.getType()</code> method).</p>
<p>When working with the <strong>accelerometer</strong>, each element in the <code>float[]</code> is the acceleration force (in <span class="math inline">\(m/s^2\)</span>) along each of the three Cartesian <strong><em>axes</em></strong> (<code>x</code>, <code>y</code>, and <code>z</code> in order):</p>
<div class="figure">
<img src="img/sensors/axis_device.png" alt="Coordinate system (relative to a mobile device). Image from source.android.com." />
<p class="caption">Coordinate system (relative to a mobile device). Image from source.android.com<a href="#fn40" class="footnoteRef" id="fnref40"><sup>40</sup></a>.</p>
</div>
</div>
<div id="composite-sensors" class="section level3">
<h3><span class="header-section-number">12.1.2</span> Composite Sensors</h3>
<p>If you Log out these coordinates while the phone sitting flat on a table (not moving), you will notice that the numbers are not all <code>0.0</code>. This is because <em>gravity</em> is always exerting an accelerating force, even when the device is at rest! Thus in order to determine the actual acceleration, we would need to “factor out” the force due to gravity. This requires a little bit of linear algebra; <a href="https://developer.android.com/guide/topics/sensors/sensors_motion.html#sensors-motion-accel">the Android documentation</a> has an example of the math (and an additional version can be found in <a href="https://github.com/android/platform_development/blob/master/samples/AccelerometerPlay/src/com/example/android/accelerometerplay/AccelerometerPlayActivity.java">the sample app</a>).</p>
<p>However, an easier solution is to utilize a <em>second</em> sensor. For example, we can read the current force due to gravity from a <em>magnetometer</em> or a <em>gyroscope</em>, and then do some math to subtract that reading from the accelerometer.</p>
<p>We can effectively combine these two sets of readings by listening not to the <em>accelerometer</em>, but to the <a href="https://source.android.com/devices/sensors/sensor-types.html#linear_acceleration"><strong><em>Linear acceleration</em></strong></a> sensor instead. This is an example of a <strong>composite sensor</strong>, a “virtual” sensor that combines readings from multiple pieces of hardware to produce useful results. Composite sensors allow us to query a single sensor for a set of data, even if that data is being synthesized from multiple other sensor components (similar to how the FusedLocationApi allows us to get location from multiple receivers). For example, the <em>linear acceleration</em> sensor uses the <em>accelerometer</em> in combination with the <em>gyroscope</em>, or the <em>magnetometer</em> if there is no gyroscope. This sensor is thus able to sample the acceleration independent of the gravity automatically.</p>
<ul>
<li><p>It is theoretically possible for a device to provide dedicated hardware for a composite sensor, but no distinction is made by the Android software.</p></li>
<li><p>Note that not all devices will have a <em>linear acceleration</em> sensor!</p></li>
</ul>
<p>Android provides many such compound sensors, and they are incredibly useful for simplying sensor interactions.</p>
</div>
</div>
<div id="rotation" class="section level2">
<h2><span class="header-section-number">12.2</span> Rotation</h2>
<p>Acceleration is all good and well, but it only detects motion when the phone is <em>moving</em>. If we tilt the phone to one side, it will measure that movement… but then the acceleration goes back to 0 since the phone has stopped moving. What if we want to detect something like the <strong>tilt</strong> of the device?</p>
<p>The <em>gravity sensor</em> (<code>TYPE_GRAVITY</code>) can give this information indirectly, but it is a bit hard to parse out. So a better option is to use a <a href="https://source.android.com/devices/sensors/sensor-types.html#rotation_vector"><strong>Rotation Vector Sensor</strong></a>. This is another <strong>composite</strong> (virtual) sensor that is used to determine the current rotation (angle) of the device by combining readings from the <em>accelerometer</em>, <em>magnetometer</em>, and <em>gyroscope</em>.</p>
<p>After registering a listener for this sensor, we can see that the <code>onSensorChanged(event)</code> callback once again provides three <code>float</code> values from the sensed event. These values represent the phone’s rotation in <a href="https://en.wikipedia.org/wiki/Quaternion">quaternions</a>. This is a lovely but complex coordinate system (literally complex: it uses imaginary numbers to measure angles). Instead, we’d like to convert this into rotation values that we understand, such as the degrees of device <a href="https://en.wikipedia.org/wiki/Aircraft_principal_axes">roll, pitch, and yaw</a>.</p>
<ul>
<li>Our approach will be somewhat round-about, but it is useful for understanding how the device measures and understands its motion.</li>
</ul>
<p>In computer systems, rotations are almost always stored as <a href="https://en.wikipedia.org/wiki/Matrix_(mathematics)"><strong>matrices</strong></a> (a mathematical structure that looks like a table of numbers). Matrices can be used to multiply <a href="https://en.wikipedia.org/wiki/Vector_(mathematics_and_physics)"><strong>vectors</strong></a> to produce a <em>new</em>, transformed vector—the matrix represents a (linear) mapping. Because a “direction” (e.g., the phone’s facing) is represented by a vector, that direction can be multiplied by a matrix to represent a “change” in the direction. A matrix that happens to correspond with a transformation that rotates a vector by some angle is called a <a href="https://en.wikipedia.org/wiki/Rotation_matrix"><strong>rotation matrix</strong></a>.</p>
<div class="figure">
<img src="img/sensors/rotation.png" alt="Derivation of a 2D rotation matrix." />
<p class="caption">Derivation of a 2D rotation matrix.</p>
</div>
<ul>
<li>You can actually use matrices to represent <em>any</em> affine transformation (including movement, skewing, scaling, etc)… and these transformations can be specified for things like animation. 30% of doing 3D Computer Graphics is simply understanding and working with these transformations.</li>
</ul>
<p>Luckily, we don’t actually need to know any of the math for deriving rotation matrices, as Android has a built-in method that will automatically produce a rotation matrix from a the rotation quaternion produces by the <em>rotation vector</em> sensor: <code>SensorManager.getRotationMatrixFromVector(targetMatrix, vector)</code></p>
<ul>
<li>This method takes in a <code>float[16]</code>, representing a 4x4 matrix (one dimensions for each axis <code>x</code>, <code>y</code>, and <code>z</code>, plus one dimension to represent the “origin” in the coordinate system. These are known as <a href="https://en.wikipedia.org/wiki/Homogeneous_coordinates">homogenous coordinates</a>. This array will be filled with the resulting values of the rotation matrix. The method doesn’t produce a <code>new</code> array because allocating memory is time-intensive—so you need to provide your own (ideally reused) array.</li>
</ul>
<p>A 4x4 rotation matrix may not <em>seem</em> like much of an improvement towards getting human-readable orientation angles. So as a second step we can use the <code>SensorManager.getOrientation(matrix, targetArray)</code> method to convert that that rotation matrix into a set of <em>radian</em> values that are the angles the phone is rotated around each axis—thereby telling us the orientation. Note this method also takes a (reusable) <code>float[3]</code> as a parameter to contain the resulting angles.</p>
<ul>
<li><p>The resulting angles can be converted to degrees and outputted using some basic <code>Math</code> and <code>String</code> functions:</p>
<div class="sourceCode"><pre class="sourceCode java"><code class="sourceCode java"><span class="bu">String</span><span class="fu">.format</span>(<span class="st">&quot;</span><span class="sc">%.3f</span><span class="st">&quot;</span>,<span class="bu">Math</span>.<span class="fu">toDegrees</span>(orientation[<span class="dv">0</span>]))+<span class="st">&quot;</span><span class="sc">\u00B0</span><span class="st">&quot;</span> <span class="co">//include the degree symbol!</span></code></pre></div></li>
</ul>
<p>The <em>rotation vector</em> sensor works well enough, but another potential option in API 18+ is the <a href="https://source.android.com/devices/sensors/sensor-types.html#game_rotation_vector"><strong>Game rotation vector</strong></a> sensor. This <strong>compound</strong> sensor is almost exactly the same as the <code>ROTATION_VECTOR</code> sensor, but it does <em>not</em> use the magnetometer so is not influenced by magnetic fields. This means that rather than having “0” rotation be based on compass directions North and East, “0” rotation can be based on some other starting angle (determined by the gyroscope). This can be useful in certain situations where magnetic fields may introduce errors, but can also involve gyroscope-based sampling drift over time.</p>
<ul>
<li><p>We can easily swap this in, without changing most of our code. We can use even check the API version dynamically in Java using:</p>
<div class="sourceCode"><pre class="sourceCode java"><code class="sourceCode java"><span class="kw">if</span> (Build.<span class="fu">VERSION</span>.<span class="fu">SDK_INT</span> &gt;= Build.<span class="fu">VERSION_CODES</span>.<span class="fu">JELLY_BEAN_MR2</span>) {
    <span class="co">//... API 18+</span>
}</code></pre></div>
<p>This strategy is useful for any API dependent options, including external storage access and SMS support!</p></li>
</ul>
<div id="coordinates" class="section level3">
<h3><span class="header-section-number">12.2.1</span> Coordinates</h3>
<p>As illustrated above, motion sensors use a standard 3D Cartesian <a href="http://developer.android.com/guide/topics/sensors/sensors_overview.html#sensors-coords">coordinate system</a>, with the <code>x</code> and <code>y</code> axes matching what you expect on the screen (with the “origin” at the center of the phone), and the <code>z</code> coming <em>out</em> of the front of the device (following the <a href="https://en.wikipedia.org/wiki/Right-hand_rule">right-hand rule</a> as a proper coordinate system should). However, there are a few “gotchyas” to consider.</p>
<p>For example, note that the values returned by the <code>getOrientation()</code> method are <em>not</em> in <code>x,y,z</code> order (but instead in <code>z</code>, <code>x</code>, <code>y</code> order)—and in fact rotates around the <code>-x</code> and <code>-z</code> axes. This is detailed in the <a href="https://developer.android.com/reference/android/hardware/SensorManager.html#getOrientation(float[], float[])">documentation</a>, and can be confirmed through testing. Thus you need to be careful about exactly what units you’re working with when accessing a particular sensor!</p>
<p>Moreover, the coordinate system used by the sensors is based on the <em>device’s</em> <strong>frame of reference</strong>, not on the Activity or the software configuration! The <code>x</code> axis always goes across the “natural” orientation of the device (portrait mode for most devices, though landscape mode for some tablets), and rotating the device (e.g., into landscape mode) won’t actually change the coordinate system. This is because the sensors are responding to the <em>hardware’s</em> orientation, and not considering the software-based configuration.</p>
<ul>
<li><p>One solution to dealing with multiple configurations is to use the <code>SensorManager#remapCoordinateSystem()</code> method to “remap” the rotation matrix. With this method, you specify <em>which</em> axes should be transformed into which other axes (e.g., which axes will become the new <code>x</code> and <code>y</code>), and then pass in a rotation matrix to adjust. You can then fetch the orientation from this rotation matrix as before. You can determine the the device’s current orientation with <code>Display#getRotation()</code> method:</p>
<div class="sourceCode"><pre class="sourceCode java"><code class="sourceCode java">Display display = ((WindowManager) <span class="fu">getSystemService</span>(<span class="bu">Context</span>.<span class="fu">WINDOW_SERVICE</span>)).<span class="fu">getDefaultDisplay</span>();
display.<span class="fu">getRotation</span>();</code></pre></div></li>
<li><p>It is also common for some motion-based applications (such as games or other graphical systems) to be restricted to a single configuration, so that you wouldn’t need to dynamically handle coordinate systems within a single device.</p></li>
</ul>

</div>
</div>
</div>
<div class="footnotes">
<hr />
<ol start="37">
<li id="fn37"><p><a href="https://source.android.com/devices/sensors/sensor-types.html" class="uri">https://source.android.com/devices/sensors/sensor-types.html</a><a href="sensors.html#fnref37">↩</a></p></li>
<li id="fn38"><p><a href="https://developer.android.com/reference/android/hardware/SensorManager.html" class="uri">https://developer.android.com/reference/android/hardware/SensorManager.html</a><a href="sensors.html#fnref38">↩</a></p></li>
<li id="fn39"><p><a href="http://developer.android.com/reference/android/hardware/Sensor.html" class="uri">http://developer.android.com/reference/android/hardware/Sensor.html</a><a href="sensors.html#fnref39">↩</a></p></li>
<li id="fn40"><p><a href="https://developer.android.com/images/axis_device.png" class="uri">https://developer.android.com/images/axis_device.png</a><a href="sensors.html#fnref40">↩</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="location.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="publishing.html" class="navigation navigation-next " aria-label="Next page""><i class="fa fa-angle-right"></i></a>

<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": false,
"google": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["github", "facebook", "twitter", "google"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/info448-s17/lecture-notes/edit/master/sensors.Rmd",
"text": "Edit"
},
"download": ["android-dev-book.pdf", "android-dev-book.epub"],
"toc": {
"collapse": "section",
"scroll_highlight": true
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    if (location.protocol !== "file:" && /^https?:/.test(script.src))
      script.src  = script.src.replace(/^https?:/, '');
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
